~[tlist_sql;
    SELECT DISTINCT
        students.last_name || ', ' || students.first_name  AS student_first_last,
        students.schoolid,                                 AS schoolid,
        students.grade_level,                              AS grade_level,
        students.dcid,                                     AS students_dcid,
        students.gender,                                   AS gender,             
    FROM
    cc
    JOIN students ON students.id = cc.studentid
    WHERE
    students.schoolid = ~(curschoolid)    AND 
    cc.termid > (CASE --This makes sure that we don't pull records from past years.
                WHEN TO_CHAR(SYSDATE, 'MMDD') > '0710' AND TO_CHAR(SYSDATE, 'MMDD') <= '1231'
                    THEN TO_CHAR(ABS(1991 - TO_CHAR(SYSDATE, 'YYYY')))
                ELSE TO_CHAR(ABS(1992 - TO_CHAR(SYSDATE, 'YYYY')))
                END) || 99 AND
    students.enroll_status = 0 AND
    students.grade_level BETWEEN -2 AND 5]
    {
        "lastfirst": ~(student_first_last),
        "dcid": ~(students_dcid),
        "grade_level": ~(grade_level),
        "gender": ~(gender)
    }
[/tlist_sql]